!function(){"use strict";angular.module("freeants",[])}(),function(){"use strict";angular.module("freeants").factory("accountDataContext",["$http","helpers","path",function(e,t,n){function r(){return n.api+"/Account"}function s(){return r()+"/UserInfo"}function a(e,t){return r()+"/ForgotPassword/"+e+"/"+t}function i(){return r()+"/ResetPassword"}function o(){return r()+"/ChangePassword"}function u(e,t){return r()+"/RegisterByOnlyEmail/"+e+"/"+t}function c(){return r()+"/ConfirmAccountByOnlyEmail/"}return{forgotPassword:function(n,r){var s=e({method:"GET",headers:t.getSecurityHeaders(),url:a(n,r)}).then(function(e){return e.data});return s},changePassword:function(n){var r=e({method:"POST",headers:t.getSecurityHeaders(),url:o(),data:n}).then(function(e){return e.data});return r},resetPassword:function(n){var r=e({method:"POST",headers:t.getSecurityHeaders(),url:i(),data:n}).then(function(e){return e.data});return r},registerByOnlyEmail:function(n,r){var s=e({method:"GET",headers:t.getSecurityHeaders(),url:u(n,r)}).then(function(e){return e.data});return s},confirmAccountByOnlyEmail:function(n){var r=e({method:"POST",headers:t.getSecurityHeaders(),url:c(),data:n}).then(function(e){return e.data});return r},getUserInfo:function(){var n=e({method:"GET",headers:t.getSecurityHeaders(),url:s()}).then(function(e){return e.data});return n}}}])}(),function(){"use strict";angular.module("freeants").provider("accountManager",function(){this.userId="",this.userName="",this.access_token="",this.access_token_time="",this.access_token_date="",this.refresh_token="",this.persistent="",this.apiKey="",this.gp_access_token="",this.fb_access_token="",this.setAppName=function(e){this.appName=e},this.setStorage=function(e,t){this.storage=e,this.key=t},this.stored=function(){return null!=this.storage.getItem(this.appName+"_"+this.key)&&null!=this.storage.getItem(this.appName+"_userName")&&null!=this.storage.getItem(this.appName+"_userId")&&"true"==this.storage.getItem(this.appName+"_remember")&&null!=this.storage.getItem(this.appName+"_access_token_time")&&null!=this.storage.getItem(this.appName+"_access_token_date")?(console.log("pass"),this.userId=this.storage.getItem(this.appName+"_userId"),this.userName=this.storage.getItem(this.appName+"_userName"),this.access_token=this.storage.getItem(this.appName+"_"+this.key),this.persistent=this.storage.getItem(this.appName+"_remember"),this.access_token_time=this.storage.getItem(this.appName+"_access_token_time"),this.access_token_date=this.storage.getItem(this.appName+"_access_token_date"),!0):(console.log("no-pass"),!1)},this.setAccessToken=function(e){this.apiKey="",this.storage.setItem(this.appName+"_"+this.key,e),this.access_token=e},this.setRefreshToken=function(e){this.storage.setItem(this.appName+"_refresh_token",e),this.refresh_token=e},this.setGoogleAccessToken=function(e){this.storage.setItem(this.appName+"_gp_access_token",e),this.gp_access_token=e},this.setFacebookAccessToken=function(e){this.storage.setItem(this.appName+"_fb_access_token",e),this.fb_access_token=e},this.setApiKey=function(e){this.access_token="",this.storage.setItem(this.appName+"_"+this.key,e),this.apiKey=e},this.setPersistent=function(e){this.storage.setItem(this.appName+"_remember",e),this.persistent=e},this.removeAccessToken=function(){this.storage.removeItem(this.appName+"_"+this.key),this.access_token=""},this.removePersistent=function(){this.storage.removeItem(this.appName+"_remember"),this.persistent=""},this.removeUserName=function(){this.storage.removeItem(this.appName+"_userName"),this.userName=""},this.removeUserId=function(){this.storage.removeItem(this.appName+"_userId"),this.userId=""},this.$get=function(){var e=this.storage,t=this.appName,n=this.key,r=this.userId,s=this.userName,a=this.persistent;return{storage:e,userId:r,userName:s,persistent:a,access_token:this.access_token,refresh_token:this.refresh_token,access_token_time:this.access_token_time,access_token_date:this.access_token_date,apiKey:this.apiKey,gp_access_token:this.gp_access_token,fb_access_token:this.fb_access_token,setAccessToken:function(r){e.setItem(t+"_"+n,r),this.access_token=r},setRefreshToken:function(n){e.setItem(t+"_refresh_token",n),this.refresh_token=n},setAccessTokenTime:function(n){e.setItem(t+"_access_token_time",n),this.access_token_time=1e3*n},setAccessTokenDate:function(n){e.setItem(t+"_access_token_date",n),this.access_token_date=n},setGoogleAccessToken:function(n){e.setItem(t+"_gp_access_token",n),this.gp_access_token=n},setFacebookAccessToken:function(n){e.setItem(t+"_fb_access_token",n),this.fb_access_token=n},setApiKey:function(r){e.setItem(t+"_"+n,r),this.apiKey=r},setUserId:function(n){e.setItem(t+"_userId",n),this.userId=n},setUserName:function(n){e.setItem(t+"_userName",n),this.userName=n},setPersistent:function(n){e.setItem(t+"_remember",n),this.persistent=n},removeAccessToken:function(){e.removeItem(t+"_"+n),this.access_token=""},removeRefreshToken:function(){e.removeItem(t+"_refresh_token"),this.refresh_token=""},removeGoogleAccessToken:function(){e.removeItem(t+"_gp_access_token"),this.gp_access_token=""},removeFacebookAccessToken:function(){e.removeItem(t+"_fb_access_token"),this.fb_access_token=""},removePersistent:function(){e.removeItem(t+"_remember"),this.persistent=""},removeUserName:function(){e.removeItem(t+"_userName"),this.userName=""},removeUserId:function(){e.removeItem(t+"_userId"),this.userId=""}}}}).service("accountManagerService",["loginDataContext","accountDataContext","path","accountManager","$http",function(e,t,n,r,s){var a={grant_type:"refresh_token",refresh_token:""},i=null,o=function(t,s){return e.login(n.server,t).then(function(e){return r.setUserId(e.userId),r.setUserName(e.userName),r.setAccessToken(e.access_token),r.setRefreshToken(e.refresh_token),r.setAccessTokenTime(e.expires_in),r.setAccessTokenDate(e[".expires"]),r.setPersistent(s),i=setTimeout(function(){a.refresh_token=r.refresh_token,u(a)},r.access_token_time),{status:!0,data:e}},function(){return{status:!1}})},u=function(t){return e.refresh(n.server,t).then(function(e){return r.setAccessToken(e.access_token),r.setRefreshToken(e.refresh_token),r.setAccessTokenTime(e.expires_in),i=setTimeout(function(){a.refresh_token=r.refresh_token,u(a)},r.access_token_time),{status:!0,data:e}},function(){return i=setTimeout(function(){a.refresh_token=r.refresh_token,u(a)},3e4),{status:!1}})},c=function(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds());return!!r.access_token&&!(Date.parse(r.access_token_date)<=Date.parse(t))},h=function(e){var t={method:"POST",url:n.api+"/Account/FacebookLogin",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*"}};return s(t).then(function(t){var a=t.data,i=a.access_token;if(a.has_registered){var o={method:"GET",url:n.api+"/Account/UserInfo",contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*",Authorization:"Bearer "+i}};s(o).then(function(e){r.setUserId(a.userId),r.setUserName(a.userName)},function(e){return{status:!1}})}return r.setAccessToken(i),r.setFacebookAccessToken(e),r.setPersistent(!0),{status:!0,data:t}},function(){return{status:!1}})},g=function(e){var t={method:"POST",url:n.api+"/Account/GoogleLogin",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*"}};return s(t).then(function(t){var a=t.data,i=a.access_token;if(a.has_registered){var o={method:"GET",url:n.api+"/Account/UserInfo",contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*",Authorization:"Bearer "+i}};s(o).then(function(e){r.setUserId(a.userId),r.setUserName(a.userName)},function(e){return{status:!1}})}return r.setAccessToken(i),r.setFacebookAccessToken(e),r.setPersistent(!0),{status:!0,data:t}},function(){return{status:!1}})},l=function(){return e.logout(n.server).then(function(){return r.removeUserName(),r.removeUserId(),r.removePersistent(),r.removeAccessToken(),r.removeRefreshToken(),i&&clearTimeout(i),r.gp_access_token&&r.removeGoogleAccessToken(),r.fb_access_token&&r.removeFacebookAccessToken(),{status:!0}},function(){return{status:!1}})},d=function(e,n){return t.forgotPassword(e,n)};return{getAccessToken:function(){return r.access_token},getRefreshToken:function(){return r.refresh_token},getAccessTokenTime:function(){return r.access_token_time},getAccessTokeDate:function(){return r.access_token_date},getApiKey:function(){return r.apiKey},getUserInfo:function(){return{userName:r.userName,userId:r.userId}},getExtraTokens:function(){return{fb_access_token:r.fb_access_token,gp_access_token:r.gp_access_token}},getExtraInfo:function(){return{persistent:r.persistent,storage:r.storage}},login:o,refresh:u,checkAccessToken:c,loginFB:h,loginGP:g,logout:l,forgotPassword:d}}])}(),function(){"use strict";angular.module("freeants").factory("asyncLoader",["$q","$timeout","translationService",function(e,t,n){var r=function(r){var s=e.defer(),a=n.getLanguages(),i={};return a&&a[r.key]&&(i=a[r.key]),t(function(){s.resolve(i)},2e3),s.promise};return r}])}(),function(){"use strict";angular.module("freeants").constant("thingClaims",{ThingUserRoleAdministrator:1,ThingUserRoleUser:2,ThingUserRoleSuperAdministrator:4,ThingUserStatusOk:1,ThingUserStatusWaitForAuth:2,ThingUserVisibilityVisible:1,ThingUserVisibilityHidden:2,ThingDeletedStatusOk:1,ThingDeletedStatusDeleted:2,ThingUserReadClaimsCanReadThingUserChangeClaims:1,ThingUserReadClaimsCanReadCreationDate:2,ThingUserReadClaimsCanReadName:4,ThingUserReadClaimsCanReadDescription:8,ThingUserReadClaimsCanReadKind:16,ThingUserReadClaimsCanReadValue:32,ThingUserReadCanReadDeletedStatus:64,ThingUserReadClaimsCanReadThingUserRights:128,ThingUserReadClaimsCanReadThingUserRole:256,ThingUserReadClaimsCanReadThingUserStatus:512,ThingUserReadClaimsCanReadThingUserReadClaims:1024,ThingUserReadClaimsCanReadPublicReadClaims:2048,ThingUserReadClaimsCanReadPublicChangeClaims:4096,ThingUserReadClaimsCanReadEveryoneReadClaims:8192,ThingUserReadClaimsCanReadEveryoneChangeClaims:16384,ThingUserChangeClaimsCanDeleteThing:1,ThingUserChangeClaimsCanChangeName:2,ThingUserChangeClaimsCanChangeDescription:4,ThingUserChangeClaimsCanChangeKind:8,ThingUserChangeClaimsCanChangeValue:16,ThingUserChangeClaimsCanChangeDeletedStatus:32,ThingUserChangeClaimsCanAddThingUserRights:64,ThingUserChangeClaimsCanDeleteThingUserRights:128,ThingUserChangeClaimsCanChangeThingUserRole:256,ThingUserChangeClaimsCanChangeThingUserStatus:512,ThingUserChangeClaimsCanChangeThingUserReadClaims:1024,ThingUserChangeClaimsCanChangeThingUserChangeClaims:2048,ThingUserChangeClaimsCanChangePublicReadClaims:4096,ThingUserChangeClaimsCanChangePublicChangeClaims:8192,ThingUserChangeClaimsCanChangeEveryoneReadClaims:16384,ThingUserChangeClaimsCanChangeEveryoneChangeClaims:32768,ThingUserChangeClaimsCanAddChildrenThing:65536,ThingUserChangeClaimsCanRemoveChildrenThing:131072,ThingUserReadClaimsNoClaims:0,ThingUserChangeClaimsNoClaims:0,ThingUserReadClaimsAllClaims:2147483647,ThingUserChangeClaimsAllClaims:2147483647})}(),function(){"use strict";angular.module("freeants").factory("helpers",["accountManager",function(e){return{getSecurityHeaders:function(){var t=e.access_token;if(t)return{Authorization:"Bearer "+t};var n=e.apiKey;return n?{DWApiKey:n}:{}},collect:function(){for(var e={},t=arguments.length,n=0;n<t;n++)for(var r in arguments[n])arguments[n].hasOwnProperty(r)&&(e[r]=arguments[n][r]);return e},getTotalItemsFromResponse:function(e){var t=e.headers("Content-Range");if(void 0!=t&&null!=t){var n=t.split("/");if(2==n.length)return parseInt(n[1])}return null},getRangeItemsFromResponse:function(e){var t=e.headers("Content-Range"),n=0,r=0,s=0;if(t){var a=t.split("/");if(0!=a.length){var i=a[0].split(" ");if(2==i.length){var o=i[1].split("-");2==o.length&&(n=parseInt(o[0]),r=parseInt(o[1]))}2==a.length&&(s=parseInt(a[1]))}}return{top:n,skip:r,totalItems:s}},generateUUID:function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t},getQueryStrParamByName:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},validateEmail:function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}}}])}(),function(){"use strict";angular.module("freeants").factory("localizator",["$translate",function(e){var t="Language",n=[{name:"English",code:"en-GB"},{name:"Italian",code:"it-IT"}];return{setLocalStorageLabel:function(e){t=e},setSupportedLanguages:function(e){n=e},getSupportedLanguages:function(){return n},changeLanguage:function(r){for(var s=n[0].code,a=0;a<n.length;a++)if(r==n[a].code){localStorage.setItem(t,r),s=r;break}e.use(s)},initLanguage:function(r){var s=localStorage.getItem(t);if(!s){s=n[0].code;for(var a=0;a<n.length;a++)if(r==n[a].code){s=r;break}}e.use(s)}}}])}(),function(){"use strict";angular.module("freeants").factory("loginDataContext",["$http","helpers",function(e,t){var n="Token",r="api/Account/Logout";return{login:function(t,r){var s=e({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:t+n,data:$.param(r)}).then(function(e){return e.data});return s},logout:function(n){var s=e({method:"POST",headers:t.getSecurityHeaders(),url:n+r}).then(function(e){return e.data});return s},refresh:function(t,r){var s=e({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:t+n,data:$.param(r)}).then(function(e){return e.data});return s}}}])}(),function(){"use strict";angular.module("freeants").factory("SignalRConnector",function(){function e(e,s){r.logging=!0,r.received(function(e){}),r.error(function(e){}),r.stateChanged(function(t){t.newState===$.signalR.connectionState.connected?(a=!0,i=!0):t.newState===$.signalR.connectionState.disconnected?a=!1:t.newState===$.signalR.connectionState.connecting||t.newState===$.signalR.connectionState.reconnecting,null!=e&&e(t)}),r.reconnected(function(){null!=s&&s()}),r.starting(function(){}),r.connectionSlow(function(){}),r.reconnecting(function(){}),r.disconnected(function(){0!=i&&setTimeout(function(){r.qs=angular.fromJson('{"'+t+'":"'+n()+'"}'),r.start()},5e3)})}var t="",n=null,r=$.hubConnection(),s=r.createHubProxy("signalrnotifier"),a=!1,i=!0;return e.prototype={connected:$.signalR.connectionState.connected,disconnected:$.signalR.connectionState.disconnected,connecting:$.signalR.connectionState.connecting,reconnecting:$.signalR.connectionState.reconnecting,subscribe:function(e,s,i,o,u){if(1!=a){n=i,t=s;var c='{"'+s+'":"'+n()+'"}';e&&""!==e&&(r.url=e),r.qs=angular.fromJson(c),r.start().done(function(){null!=o&&o()}).fail(function(){null!=u&&u()})}},unsubscribe:function(){0!=a&&(i=!1,r.stop())},setHook:function(e,t){s.on(e,t)}},e}),angular.module("freeants").factory("notifierConnector",function(){var e="",t=null,n=$.hubConnection(),r=n.createHubProxy("signalrnotifier"),s=!1,a=!0;return{connected:$.signalR.connectionState.connected,disconnected:$.signalR.connectionState.disconnected,connecting:$.signalR.connectionState.connecting,reconnecting:$.signalR.connectionState.reconnecting,init:function(r,i){n.logging=!0,n.received(function(e){}),n.error(function(e){}),n.stateChanged(function(e){e.newState===$.signalR.connectionState.connected?(s=!0,a=!0):e.newState===$.signalR.connectionState.disconnected?s=!1:e.newState===$.signalR.connectionState.connecting||e.newState===$.signalR.connectionState.reconnecting,null!=r&&r(e)}),n.reconnected(function(){null!=i&&i()}),n.starting(function(){}),n.connectionSlow(function(){}),n.reconnecting(function(){}),n.disconnected(function(){0!=a&&setTimeout(function(){n.qs=angular.fromJson('{"'+e+'":"'+t()+'"}'),n.start()},5e3)})},subscribe:function(r,a,i,o,u){if(1!=s){t=i,e=a;var c='{"'+a+'":"'+t()+'"}';r&&""!==r&&(n.url=r),n.qs=angular.fromJson(c),n.start().done(function(){null!=o&&o()}).fail(function(){null!=u&&u()})}},unsubscribe:function(){0!=s&&(a=!1,n.stop())},setHook:function(e,t){r.on(e,t)}}})}(),function(){"use strict";angular.module("freeants").factory("pushNotificationsDataContext",["$http","helpers","path","$q",function(e,t,n,r){function s(){return n.api+"/pushNotificationsRegister"}function a(){return n.api+"/pushNotificationsPush"}return{register:function(n){var r=e({method:"PUT",headers:t.getSecurityHeaders(),url:s(),data:n}).then(function(e){return e.data});return r},push:function(n){var r=e({method:"POST",headers:t.getSecurityHeaders(),url:a(),data:n}).then(function(e){return e.data});return r}}}])}(),function(){"use strict";angular.module("freeants").factory("schedulerDataContext",["$http","helpers","path",function(e,t,n){function r(){return n.api+"/Scheduler"}return{schedule:function(n){var s=e({method:"POST",headers:t.getSecurityHeaders(),url:r(),data:n}).then(function(e){return e.data});return s},update:function(n,s){var a=e({method:"PUT",headers:t.getSecurityHeaders(),url:r()+"/"+s,data:n}).then(function(e){return e.data});return a},"delete":function(n,s){var a=e({method:"POST",headers:t.getSecurityHeaders(),url:r()+"/"+s,data:{thingId:n}}).then(function(e){return e.data});return a}}}])}(),function(){"use strict";angular.module("freeants").factory("thingsDataContext",["$http","helpers","path","$q",function(e,t,n,r){function s(e,t){return n.api+"/things/"+e+"/childrenIds/"+(t||"")}function a(e){return n.api+"/things/"+(e||"")}function i(e){return n.api+"/things/"+e+"/value"}function o(){return n.api+"/things/position"}function u(e,t){return n.api+"/things/"+e+"/childrenIds/"+t}var c=function(){var n=r.defer(),s=function(e){n.resolve(e)},i=e({method:"GET",headers:t.getSecurityHeaders(),timeout:n.promise,url:a()+"?"+(parameter.parentThingId?"&$parentId="+parameter.parentThingId:"")+(parameter.filter?"&$filter="+parameter.filter:"")+(parameter.top?"&$top="+parameter.top:"")+(parameter.skip?"&$skip="+parameter.skip:"")+(null==parameter.deleteStatus||void 0==parameter.deleteStatus?"":"&$deletedStatus="+parameter.deleteStatus)+(parameter.orderBy?"&$orderby="+parameter.orderBy:"")+(parameter.valueFilter?"&$valueFilter="+parameter.valueFilter:"")}).then(function(e){return e.data});return{promise:i,cancel:s}};return{getThings:function(n,r){var s=a()+"?"+(n.parentThingId?"&$parentId="+n.parentThingId:"")+(n.filter?"&$filter="+n.filter:"")+(n.top?"&$top="+n.top:"")+(n.skip?"&$skip="+n.skip:"")+(null==n.deleteStatus||void 0==n.deleteStatus?"":"&$deletedStatus="+n.deleteStatus)+(n.orderBy?"&$orderby="+n.orderBy:"")+(n.valueFilter?"&$valueFilter="+n.valueFilter:""),i=e({method:"GET",headers:t.getSecurityHeaders(),timeout:r?r.promise:null,url:s}).then(function(e){return e.data});return i},getThings1:function(n,r){var s=a()+"?"+(n.parentThingId?"&$parentId="+n.parentThingId:"")+(n.filter?"&$filter="+n.filter:"")+(n.top?"&$top="+n.top:"")+(n.skip?"&$skip="+n.skip:"")+(null==n.deleteStatus||void 0==n.deleteStatus?"":"&$deletedStatus="+n.deleteStatus)+(n.orderBy?"&$orderby="+n.orderBy:"")+(n.valueFilter?"&$valueFilter="+n.valueFilter:""),i=e({method:"GET",headers:t.getSecurityHeaders(),timeout:r?r.promise:null,url:s}).then(function(e){return{things:e.data,itemsRange:t.getRangeItemsFromResponse(e)}});return i},getThing:function(n){var r=e({method:"GET",headers:t.getSecurityHeaders(),url:a(n)}).then(function(e){return e.data});return r},getThingsWithAbort:c,createThing:function(n){var r=e({method:"POST",headers:t.getSecurityHeaders(),url:a(),data:n}).then(function(e){return e.data});return r},updateThing:function(n,r){var s=e({method:"PUT",headers:t.getSecurityHeaders(),url:a(n),data:r}).then(function(e){return e.data});return s},deleteThing:function(n){var r=e({method:"DELETE",headers:t.getSecurityHeaders(),url:a(n)}).then(function(e){return e.data});return r},getChildrenIds:function(n){var r=e({method:"GET",headers:t.getSecurityHeaders(),url:s(n)}).then(function(e){return e.data});return r},addChildToParent:function(n,r){var a=e({method:"POST",headers:t.getSecurityHeaders(),url:s(n),data:angular.toJson(r)}).then(function(e){return e.data});return a},deleteThingChild:function(n,r){var s=e({method:"DELETE",headers:t.getSecurityHeaders(),url:u(n,r)}).then(function(e){return e.data});return s},getThingValue:function(n,r){var s=e({method:"GET",headers:t.getSecurityHeaders(),url:i(n)}).then(function(e){return e.data});return s},putThingValue:function(n,r){var s=e({method:"PUT",headers:t.getSecurityHeaders(),url:i(n),data:r}).then(function(e){return e.data});return s},putThingPosition:function(n,r,s){var a=e({method:"PUT",headers:t.getSecurityHeaders(),url:o(),data:JSON.stringify({parentId:n,childId:r,pos:s})}).then(function(e){return e.data});return a}}}])}(),function(){"use strict";angular.module("freeants").factory("ThingModel",[function(){function e(e){this.childrenSkip=0,this.childrenTotalItems=Number.MAX_SAFE_INTEGER,this.children=[],this.setData(e)}return e.prototype={setData:function(e){e&&angular.extend(this,e),null!=this.value&&""!=this.value||(this.value={}),this.value=angular.fromJson(this.value)}},e}])}(),function(){"use strict";angular.module("freeants").factory("ThingsManager",["$q","ThingModel",function(e,t){function n(e){r=e}var r;return n.prototype={getThings:function(e,n){function s(e){for(var n=[],r=0;r<e.length;r++){var s=new t(e[r]);n.push(s)}return n}return r.thingsDataContext.getThings(e,n).then(s)},toThingModel:function(e,n,r){for(var s=0;s<e.length;s++){var a=new t;a.kind=r,a.value=e[s],n.push(a)}},getThingsTree:function(n,s){function a(i,o){var u=o||[];return r.thingsDataContext.getThings(n,s).then(function(r){0==r.length&&i.resolve(u);for(var s=[],o=0;o<r.length;o++){var c=new t(r[o]);u.push(c);var h=e.defer();s.push(h.promise),n.parentThingId=c.id,a(h,c.children)}e.all(s).then(function(e){i.resolve(u)},function(e){i.reject(e)})},function(e){i.reject(e)}),i.promise}var i=e.defer();return a(i)}},n}]),angular.module("freeants").factory("thingsManager",["$q","thingsDataContext","ThingModel",function(e,t,n){function r(e){return t.createThing(e).then(function(e){return new n(e)})}function s(e,r){function s(e){for(var t=[],r=0;r<e.things.length;r++){var s=new n(e.things[r]);t.push(s)}return{things:t,itemsRange:e.itemsRange}}return t.getThings1(e,r).then(s)}function a(e,t,n){return t.skip=e.childrenSkip,t.parentThingId=e.id,s(t,n).then(function(n){e.childrenTotalItems=n.itemsRange.totalItems,e.childrenSkip=e.childrenSkip+t.top,e.childrenSkip>e.childrenTotalItems&&(e.childrenSkip=e.childrenTotalItems);for(var r=0;r<n.things.length;r++)e.children.push(n.things[r]);return n})}function i(e,t){t&&t.resolve(),e.children=[],e.childrenSkip=0}function o(n){return t.getChildrenIds(n).then(function(n){for(var r=e.defer(),s=[],a=0;a<n.length;a++)s.push(t.deleteThing(n[a]));return e.all(s).then(function(e){return r.resolve(e),e},function(e){return r.reject(e),e})})}return{createThing:r,getThings:s,elapseThing:a,collapseThing:i,deleteChildrenThings:o}}])}(),function(){"use strict";angular.module("freeants").factory("thingUserRightsDataContext",["$q","$http","helpers","path",function(e,t,n,r){function s(e,t){return r.api+"/things/"+e+"/usersrights"+(void 0!=t?"/"+t:"")}return{getThingUsersRights:function(r){var a=t({method:"GET",headers:n.getSecurityHeaders(),url:s(r.thingId)+"?&parentId="+(null==r.id||void 0==r.id?"":r.id)+(null!=r.filter||void 0!=r.filter?"&$filter="+r.filter:"")+(null!=r.top||void 0!=r.top?"&$top="+r.top:"")+(null!=r.skip||void 0!=r.skip?"&$skip="+r.skip:"")+(null!=r.orderBy||void 0!=r.orderBy?"&$orderby="+r.orderBy:"")}).then(function(e){return e.data},function(t){return e.reject(t)});return a},createThingUserRights:function(r,a){var i=t({method:"POST",headers:n.getSecurityHeaders(),url:s(r),data:a}).then(function(e){return e.data},function(t){return e.reject(t)});return i},updateThingUserRights:function(r,a,i){var o=t({method:"PUT",headers:n.getSecurityHeaders(),url:s(r,a),data:i}).then(function(e){return e.data},function(t){return e.reject(t)});return o},deleteThingUserRights:function(r,a){var i=t({method:"DELETE",headers:n.getSecurityHeaders(),url:s(r,a)}).then(function(e){return e.data},function(t){return e.reject(t)});return i}}}])}(),function(){"use strict";angular.module("freeants").factory("translationService",["$translate",function(e){var t={},n=[];return{getSupportedLanguages:function(){return n},changeLanguage:function(t){for(var r=n[0].code,s=0;s<n.length;s++)if(t==n[s].code){localStorage.setItem("Language",t),r=t;break}e.refresh(r),e.use(r)},initLanguage:function(t){var r=localStorage.getItem("Language");if(!r){r=n[0].code;for(var s=0;s<n.length;s++)if(t==n[s].code){r=t;break}}e.refresh(r),e.use(r)},setLanguages:function(e){t=angular.extend(t,e)},initialize:function(e){t=angular.extend(t,e)},getLanguages:function(e){return t},setSupportedLanguages:function(e){n=e},getSupportedLanguages:function(){return n},setGlobalization:function(t){var r="English",s="en",a=t;a||(a=e.use());for(var i=0;i<n.length;i++)a==n[i].language&&(r=n[i].deviceLanguage,s=n[i].deviceCulture);e.refresh(s),e.use(s)}}}])}(),function(){"use strict";angular.module("freeants").factory("userDataContext",["$http","helpers","path",function(e,t,n){function r(e){return n.api+"/users/"+(e||"")}return{getUsers:function(n,s){var a=e({method:"GET",headers:t.getSecurityHeaders(),timeout:s?s.promise:null,url:r()+"?"+(n.filter?"&$filter="+n.filter:"")+(n.top?"&$top="+n.top:"")+(n.skip?"&$skip="+n.skip:"")+(n.orderBy?"&$orderby="+n.orderBy:"")}).then(function(e){return{users:e.data,itemsRange:t.getRangeItemsFromResponse(e)}});return a},getUser:function(n){var s=e({method:"GET",headers:t.getSecurityHeaders(),url:r(n)}).then(function(e){return e.data});return s},createUser:function(n){var s=e({method:"POST",headers:t.getSecurityHeaders(),url:r(),data:n}).then(function(e){return e.data});return s},updateUser:function(n,s){var a=e({method:"PUT",headers:t.getSecurityHeaders(),url:r(n),data:s}).then(function(e){return e.data});return a},deleteUser:function(n){var s=e({method:"DELETE",headers:t.getSecurityHeaders(),url:r(n)}).then(function(e){return e.data});return s}}}])}(),function(){"use strict";angular.module("freeants").factory("UsersManager",["$q","$filter","userDataContext",function(e,t,n){function r(){this.skip=0,this.usersTotalItems=Number.MAX_SAFE_INTEGER,this.users=[],this.getUsersParams={filter:"",top:5,skip:this.skip,orderBy:null}}return r.prototype.getUser=function(r){var s=t("filter")(this.users,{id:r});if(0!=s.length){var a=e.defer();return a.resolve(s[0]),a.promise}return n.getUser(r)},r.prototype.getMoreUsers=function(e){var t=this;return t.getUsersParams.skip=t.skip,n.getUsers(this.getUsersParams,e).then(function(e){t.usersTotalItems=e.itemsRange.totalItems,t.skip+=t.getUsersParams.top,t.skip>t.usersTotalItems&&(t.skip=t.usersTotalItems);for(var n=0;n<e.users.length;n++)t.users.push(e.users[n]);return e})},r.prototype.getUsersTotalItems=function(){return this.usersTotalItems},r}])}();