!function(){"use strict";angular.module("freeants",[])}(),function(){"use strict";angular.module("freeants").factory("accountDataContext",["$http","helpers","path",function(e,n,t){function r(){return t.server+"Token"}function i(){return t.api+"/Account"}function a(){return i()+"/Logout"}function s(){return i()+"/UserInfo"}function o(e,n){return i()+"/ForgotPassword/"+e+"/"+n}function u(){return i()+"/ResetPassword"}function h(){return i()+"/ChangePassword"}function g(e,n){return i()+"/RegisterByOnlyEmail/"+e+"/"+n}function c(){return i()+"/ConfirmAccountByOnlyEmail/"}return{login:function(n){var t=e({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:r(),data:$.param(n)}).then(function(e){return e.data});return t},logout:function(){var t=e({method:"POST",headers:n.getSecurityHeaders(),url:a()}).then(function(e){return e.data});return t},refresh:function(n){var t=e({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:r(),data:$.param(n)}).then(function(e){return e.data});return t},forgotPassword:function(t,r){var i=e({method:"GET",headers:n.getSecurityHeaders(),url:o(t,r)}).then(function(e){return e.data});return i},changePassword:function(t){var r=e({method:"POST",headers:n.getSecurityHeaders(),url:h(),data:t}).then(function(e){return e.data});return r},resetPassword:function(t){var r=e({method:"POST",headers:n.getSecurityHeaders(),url:u(),data:t}).then(function(e){return e.data});return r},registerByOnlyEmail:function(t,r){var i=e({method:"GET",headers:n.getSecurityHeaders(),url:g(t,r)}).then(function(e){return e.data});return i},confirmAccountByOnlyEmail:function(t){var r=e({method:"POST",headers:n.getSecurityHeaders(),url:c(),data:t}).then(function(e){return e.data});return r},getUserInfo:function(){var t=e({method:"GET",headers:n.getSecurityHeaders(),url:s()}).then(function(e){return e.data});return t}}}])}(),function(){"use strict";angular.module("freeants").provider("accountManager",function(){var e="",n="",t="",r="",i="",a="",s="",o="",u="",h="",g="",c="",l=function(){r="",i="",a="",s="",o="",u="",h="",g="",c="",localStorage.removeItem(e+"__remember"),localStorage.removeItem(e+"_"+t),sessionStorage.removeItem(e+"_"+t),localStorage.removeItem(e+"_remember"),sessionStorage.removeItem(e+"_remember"),localStorage.removeItem(e+"_userId"),sessionStorage.removeItem(e+"_userId"),localStorage.removeItem(e+"_userName"),sessionStorage.removeItem(e+"_userName"),localStorage.removeItem(e+"_access_token_time"),sessionStorage.removeItem(e+"_access_token_time"),localStorage.removeItem(e+"_access_token_date"),sessionStorage.removeItem(e+"_access_token_date"),localStorage.removeItem(e+"_refresh_token"),sessionStorage.removeItem(e+"_refresh_token"),localStorage.removeItem(e+"_gp_access_token"),sessionStorage.removeItem(e+"_gp_access_token"),localStorage.removeItem(e+"_fb_access_token"),sessionStorage.removeItem(e+"_fb_access_token")};this.setAppName=function(n,r){e=n,t=r},this.setApiKey=function(e){l(),r=e},this.readLoginData=function(){r="",i=sessionStorage.getItem(e+"_"+t),a=sessionStorage.getItem(e+"_access_token_time"),s=sessionStorage.getItem(e+"_access_token_date"),o=sessionStorage.getItem(e+"_refresh_token"),u=sessionStorage.getItem(e+"_userId"),h=sessionStorage.getItem(e+"_userName"),g=sessionStorage.getItem(e+"_gp_access_token"),c=sessionStorage.getItem(e+"_fb_access_token"),localStorage.getItem(e+"_remember")&&(i=localStorage.getItem(e+"_"+t),a=localStorage.getItem(e+"_access_token_time"),s=localStorage.getItem(e+"_access_token_date"),o=localStorage.getItem(e+"_refresh_token"),u=localStorage.getItem(e+"_userId"),h=localStorage.getItem(e+"_userName"),g=localStorage.getItem(e+"_gp_access_token"),c=localStorage.getItem(e+"_fb_access_token"))},this.$get=[function(){return{resetStorages:l,setPersistent:function(t){localStorage.setItem(e+"_remember",t),n=t},setAccessToken:function(r){sessionStorage.setItem(e+"_"+t,r),n&&localStorage.setItem(e+"_"+t,r),i=r},setRefreshToken:function(t){sessionStorage.setItem(e+"_refresh_token",t),n&&localStorage.setItem(e+"_refresh_token",t),o=t},setAccessTokenTime:function(t){sessionStorage.setItem(e+"_access_token_time",t),n&&localStorage.setItem(e+"_access_token_time",t),a=t},setAccessTokenDate:function(t){sessionStorage.setItem(e+"_access_token_date",t),n&&localStorage.setItem(e+"_access_token_date",t),s=t},setUserId:function(t){sessionStorage.setItem(e+"_userId",t),n&&localStorage.setItem(e+"_userId",t),u=t},setUserName:function(t){sessionStorage.setItem(e+"_userName",t),n&&localStorage.setItem(e+"_userName",t),h=t},setGoogleAccessToken:function(t){sessionStorage.setItem(e+"_gp_access_token",t),n&&localStorage.setItem(e+"_gp_access_token",t),g=t},setFacebookAccessToken:function(t){sessionStorage.setItem(e+"_fb_access_token",t),n&&localStorage.setItem(e+"_fb_access_token",t),c=t},getAccessToken:function(){return i},getRefreshToken:function(){return o},getAccessTokenDate:function(){return s},getAccessTokenTime:function(){return a},getFBAccessToken:function(){return c},getGPAccessToken:function(){return g},getApiKey:function(){return r},getUserInfo:function(){return{userName:h,userId:u}}}}]}).factory("accountManagerService",["accountDataContext","path","accountManager","$http","$q",function(e,n,t,r,i){var a=null,s=function(){a&&(clearTimeout(a),a=null)},o=function(e){return},u=function(){s(),t.resetStorages()};return{checkAccessToken:function(){var e=new Date,n=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds());return t.getAccessToken()?!(Date.parse(t.getAccessTokenDate())<=Date.parse(n))||(u(),!1):(u(),!1)},login:function(n,r){return u(),e.login(n).then(function(e){return r&&t.setPersistent(r),t.setUserId(e.userId),t.setUserName(e.userName),t.setAccessToken(e.access_token),t.setRefreshToken(e.refresh_token),t.setAccessTokenTime(e.expires_in),t.setAccessTokenDate(e[".expires"]),o(),{status:!0,data:e}},function(e){return{status:!1,data:e}})},logout:function(){return e.logout().then(function(e){return{data:e,status:!0}},function(e){return{data:e,status:!1}})["finally"](u)},forgotPassword:function(n,t){return e.forgotPassword(n,t)},loginFB:function(e){var a=i.defer(),s={method:"POST",url:n.api+"/Account/FacebookLogin",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*"}};return r(s).then(function(i){var s=i.data,o=s.access_token;if(s.has_registered){var u={method:"GET",url:n.api+"/Account/UserInfo",contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*",Authorization:"Bearer "+o}};r(u).then(function(n){return t.setPersistent(!0),t.setAccessToken(s.access_token),t.setUserId(n.data.userId),t.setUserName(n.data.userName),t.setFacebookAccessToken(e),a.resolve(n),n},function(e){return a.reject(e),e})}else{var h={responseData:s,status:!1};a.resolve(h)}return i},function(e){return a.reject(e),e}),a.promise},loginGP:function(e){var a=i.defer(),s={method:"POST",url:n.api+"/Account/GoogleLogin",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*"}};return r(s).then(function(i){var s=i.data,o=s.access_token;if(s.has_registered){var u={method:"GET",url:n.api+"/Account/UserInfo",contentType:"application/json; charset=utf-8",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"*/*",Authorization:"Bearer "+o}};r(u).then(function(n){return t.setPersistent(!0),t.setAccessToken(s.access_token),t.setUserId(n.data.userId),t.setUserName(n.data.userName),t.setGoogleAccessToken(e),a.resolve(n),n},function(e){return a.reject(e),e})}else{var h={responseData:s,status:!1};a.resolve(h)}return i},function(e){return a.reject(e),e}),a.promise}}}])}(),function(){"use strict";var e=angular.module("freeants");e.factory("ApplicationThingsManager",["$timeout","$q","thingsDataContext","notifierConnector","thingClaims","thingsManager","ThingModel","accountManager",function(e,n,t,r,i,a,s,o){function u(n,i,u,h){var g=this;this.rightsAndClaims=u,this.thingKind=i,this.mainThing=n,this.things=this.mainThing.children,this.getThingsParams={filter:"Kind eq '"+this.thingKind+"'",top:10,orderBy:null,valueFilter:null},this.getChindrenThingsParams={parentThingId:null,filter:"",top:10,skip:0,orderBy:null,valueFilter:null},this.searchThing=function(e,n){var t=null,r=-1;if(e)for(var i=0;i<e.length;i++)if(e[i].id==n){t=e[i],r=i;break}if(t)return{thing:t,thingIndex:r}},this.searchThingChild=function(e,n,t){var r=null,i=-1,a=1;if(e)for(var s=0;s<e.length;s++)if(null==t||e[s].id==t){var o=this.searchThing(e[s].children,n);if(o){r=o.thing,i=s,a=o.thingIndex;break}}return r?{child:r,appIndex:i,childIndex:a}:null},this.onCreateThing=function(n){if(n.kind==g.thingKind)return a.addThingChild(g.mainThing,n),void e(null,1)},this.onUpdateThing=function(n){var t=g.searchThing(g.mainThing.children,n.id);if(t){var r=new s(n,t.thing.children,t.thing.childrenSkip,t.thing.childrenTotalItems);return g.mainThing.children[t.thingIndex]=r,void e(null,1)}var i=g.searchThingChild(g.mainThing.children,n.id);if(i){var a=new s(n,i.child.children,i.child.childrenSkip,i.child.childrenTotalItems);return g.mainThing.children[i.appIndex].children[i.childIndex]=a,void e(null,1)}},this.onDeleteThing=function(n){var t=g.searchThing(g.mainThing.children,n);if(t)return g.mainThing.children.splice(t.thingIndex,1),void e(null,1)},this.onUpdateThingValue=function(n,t){var r=g.searchThing(g.mainThing.children,n);if(r)return r.thing.value=angular.fromJson(t),void e(null,1);var i=g.searchThingChild(g.mainThing.children,n);return i?(i.child.value=angular.fromJson(t),void e(null,1)):void 0},this.onUpdateThingPosition=function(t){if((!n.id||n.id==t.parentId)&&(n.id||!t.parentId))for(var r=0;r<g.mainThing.children.length;r++){var i=g.mainThing.children[r];if(i.id==t.childId){var a=null;return t.pos<g.mainThing.children.length&&(a=g.mainThing.children[t.pos]),g.mainThing.children[t.pos]=i,g.mainThing.children[r]=a,void e(null,1)}}},this.onCreateChildThingId=function(n,r,i){var a=g.searchThing(g.mainThing.children,n);if(a)return void t.getThing(r).then(function(n){a.thing.children.push(new s(n)),e(null,1)})},this.onDeleteChildThingId=function(n,t,r){var i=g.searchThingChild(g.mainThing.children,t,n);i&&(g.mainThing.children[i.appIndex].children.splice(i.childIndex,1),e(null,1))},this.onCreateThingUserRights=function(n,t){var r=g.searchThing(g.mainThing.children,n);if(r)return h.getUser(t.userId).then(function(e){r.thing.usersInfos.unshift(e)}),void e(null,1);var i=g.searchThingChild(g.mainThing.children,n);i?(h.getUser(t.userId).then(function(e){i.child.usersInfos.unshift(e)}),e(null,1)):a.getThing(n).then(function(n){var t=n;t&&t.kind==g.thingKind&&a.addThingChild(g.mainThing,t),e(null,1)})},this.onUpdateThingUserRights=function(e,n){},this.onDeleteThingUserRights=function(n,t){var r=o.getUserInfo(),i=g.searchThing(g.mainThing.children,n);if(i)if(t==r.userId)g.mainThing.children.splice(i.thingIndex,1);else{var a=g.searchThing(i.thing.usersInfos,t);a&&g.mainThing.children[i.thingIndex].usersInfos.splice(a.thingIndex,1)}else{var s=g.searchThingChild(g.mainThing.children,n);if(s){var a=g.searchThing(s.child.usersInfos,t);a&&g.mainThing.children[s.appIndex].children[s.childIndex].usersInfos.splice(a.thingIndex,1)}}e(null,1)},r.setHook("onCreateThing",g.onCreateThing),r.setHook("onUpdateThing",g.onUpdateThing),r.setHook("onDeleteThing",g.onDeleteThing),r.setHook("onUpdateThingValue",g.onUpdateThingValue),r.setHook("onUpdateThingPosition",g.onUpdateThingPosition),r.setHook("onCreateChildThingId",g.onCreateChildThingId),r.setHook("onDeleteChildThingId",g.onDeleteChildThingId),r.setHook("onCreateThingUserRights",g.onCreateThingUserRights),r.setHook("onUpdateThingUserRights",g.onUpdateThingUserRights),r.setHook("onDeleteThingUserRights",g.onDeleteThingUserRights)}return u.prototype.dispose=function(){r.remHook("onDeleteThingUserRights",this.onUpdateThingUserRights),r.remHook("onUpdateThingUserRights",this.onUpdateThingUserRights),r.remHook("onCreateThingUserRights",this.onCreateThingUserRights),r.remHook("onDeleteChildThingId",this.onDeleteChildThingId),r.remHook("onCreateChildThingId",this.onCreateChildThingId),r.remHook("onUpdateThingValue",this.onUpdateThingValue),r.remHook("onDeleteThing",this.onDeleteThing),r.remHook("onUpdateThing",this.onUpdateThing),r.remHook("onCreateThing",this.onCreateThing)},u.prototype.setTopChildrenThings=function(e){this.getChindrenThingsParams.top=e},u.prototype.getThingChildrenTotalsItems=function(e){return e.childrenTotalItems},u.prototype.getMoreThingChildren=function(e,n){return a.getMoreThingChildren(e,this.getChindrenThingsParams,n)},u.prototype.addChild=function(e,n){return t.addChildToParent(e,n)},u.prototype.collapseThing=function(e,n){if(this.mainThing.id==e)return void a.collapseThing(this.mainThing,n);for(var t=null,r=0;r<this.mainThing.children.length;r++)if(e==this.mainThing.children[r].id){t=this.mainThing.children[r];break}t&&a.collapseThing(t,n)},u.prototype.setTopThings=function(e){this.getThingsParams.top=e},u.prototype.getThingsTotalItems=function(){return this.mainThing.childrenTotalItems},u.prototype.getMoreThings=function(e){var t=this,r=n.defer();return a.getMoreThingChildren(this.mainThing,this.getThingsParams,e).then(function(i){for(var a=[],s=0;s<i.things.length;s++)a.push(t.getMoreThingChildren(i.things[s],e));n.all(a).then(function(e){return r.resolve(e),e},function(n){return e&&e.resolve(),r.reject(n),n})}),r.promise},u.prototype.createThing=function(e){return e.kind=this.thingKind,e.deletedStatus=i.ThingDeletedStatusOk,e.publicReadClaims=this.rightsAndClaims.PublicReadClaims,e.publicChangeClaims=this.rightsAndClaims.PublicChangeClaims,e.everyoneReadClaims=this.rightsAndClaims.EveryoneReadClaims,e.everyoneChangeClaims=this.rightsAndClaims.EveryoneChangeClaims,e.userRole=i.ThingUserRoleAdministrator,e.userStatus=i.ThingUserStatusOk,e.userReadClaims=this.rightsAndClaims.CreatorUserReadClaims,e.userChangeClaims=this.rightsAndClaims.CreatorUserChangeClaims,a.createThing(e)},u.prototype.updateThing=function(e){return t.updateThing(e.id,e)},u.prototype.deleteThing=function(e,n){return a.deleteThing(e,n)},u.prototype.shallowCopyThing=function(e){return a.shallowCopyThing(e)},u.prototype.addUser=function(e,n,t){return a.addUser(e,n,t)},u.prototype.updateUser=function(e,n,t,r){return a.updateUser(e,n,t,r)},u.prototype.removeUser=function(e,n,t){return a.removeUser(e,n,t)},u}])}(),function(){"use strict";angular.module("freeants").factory("asyncLoader",["$q","$timeout","translationService",function(e,n,t){var r=function(r){var i=e.defer(),a=t.getLanguages(),s={};return a&&a[r.key]&&(s=a[r.key]),n(function(){i.resolve(s)},2e3),i.promise};return r}])}(),function(){"use strict";angular.module("freeants").constant("thingClaims",{ThingUserRoleAdministrator:1,ThingUserRoleUser:2,ThingUserRoleSuperAdministrator:4,ThingUserStatusOk:1,ThingUserStatusWaitForAuth:2,ThingUserVisibilityVisible:1,ThingUserVisibilityHidden:2,ThingDeletedStatusOk:1,ThingDeletedStatusDeleted:2,ThingUserReadClaimsCanReadThingUserChangeClaims:1,ThingUserReadClaimsCanReadCreationDate:2,ThingUserReadClaimsCanReadName:4,ThingUserReadClaimsCanReadDescription:8,ThingUserReadClaimsCanReadKind:16,ThingUserReadClaimsCanReadValue:32,ThingUserReadClaimsCanReadDeletedStatus:64,ThingUserReadClaimsCanReadThingUserRights:128,ThingUserReadClaimsCanReadThingUserRole:256,ThingUserReadClaimsCanReadThingUserStatus:512,ThingUserReadClaimsCanReadThingUserReadClaims:1024,ThingUserReadClaimsCanReadPublicReadClaims:2048,ThingUserReadClaimsCanReadPublicChangeClaims:4096,ThingUserReadClaimsCanReadEveryoneReadClaims:8192,ThingUserReadClaimsCanReadEveryoneChangeClaims:16384,ThingUserReadClaimsAllClaims:ThingUserReadClaimsCanReadThingUserChangeClaims|ThingUserReadClaimsCanReadCreationDate|ThingUserReadClaimsCanReadName|ThingUserReadClaimsCanReadDescription|ThingUserReadClaimsCanReadKind|ThingUserReadClaimsCanReadValue|ThingUserReadClaimsCanReadDeletedStatus|ThingUserReadClaimsCanReadThingUserRights|ThingUserReadClaimsCanReadThingUserRole|ThingUserReadClaimsCanReadThingUserStatus|ThingUserReadClaimsCanReadThingUserReadClaims|ThingUserReadClaimsCanReadPublicReadClaims|ThingUserReadClaimsCanReadPublicChangeClaims|ThingUserReadClaimsCanReadEveryoneReadClaims|ThingUserReadClaimsCanReadEveryoneChangeClaims,ThingUserChangeClaimsCanDeleteThing:1,ThingUserChangeClaimsCanChangeName:2,ThingUserChangeClaimsCanChangeDescription:4,ThingUserChangeClaimsCanChangeKind:8,ThingUserChangeClaimsCanChangeValue:16,ThingUserChangeClaimsCanChangeDeletedStatus:32,ThingUserChangeClaimsCanAddThingUserRights:64,ThingUserChangeClaimsCanDeleteThingUserRights:128,ThingUserChangeClaimsCanChangeThingUserRole:256,ThingUserChangeClaimsCanChangeThingUserStatus:512,ThingUserChangeClaimsCanChangeThingUserReadClaims:1024,ThingUserChangeClaimsCanChangeThingUserChangeClaims:2048,ThingUserChangeClaimsCanChangePublicReadClaims:4096,ThingUserChangeClaimsCanChangePublicChangeClaims:8192,ThingUserChangeClaimsCanChangeEveryoneReadClaims:16384,ThingUserChangeClaimsCanChangeEveryoneChangeClaims:32768,ThingUserChangeClaimsCanAddChildrenThing:65536,ThingUserChangeClaimsCanRemoveChildrenThing:131072,ThingUserReadClaimsNoClaims:0,ThingUserChangeClaimsNoClaims:0,ThingUserChangeClaimsAllClaims:ThingUserChangeClaimsCanDeleteThing|ThingUserChangeClaimsCanChangeName|ThingUserChangeClaimsCanChangeDescription|ThingUserChangeClaimsCanChangeKind|ThingUserChangeClaimsCanChangeValue|ThingUserChangeClaimsCanChangeDeletedStatus|ThingUserChangeClaimsCanAddThingUserRights|ThingUserChangeClaimsCanDeleteThingUserRights|ThingUserChangeClaimsCanChangeThingUserRole|ThingUserChangeClaimsCanChangeThingUserStatus|ThingUserChangeClaimsCanChangeThingUserReadClaims|ThingUserChangeClaimsCanChangeThingUserChangeClaims|ThingUserChangeClaimsCanChangePublicReadClaims|ThingUserChangeClaimsCanChangePublicChangeClaims|ThingUserChangeClaimsCanChangeEveryoneReadClaims|ThingUserChangeClaimsCanChangeEveryoneChangeClaims|ThingUserChangeClaimsCanAddChildrenThing|ThingUserChangeClaimsCanRemoveChildrenThing})}(),function(){"use strict";angular.module("freeants").factory("helpers",["accountManager",function(e){return{getSecurityHeaders:function(){var n=e.getAccessToken();if(n)return{Authorization:"Bearer "+n};var t=e.getApiKey();return t?{DWApiKey:t}:{}},collect:function(){for(var e={},n=arguments.length,t=0;t<n;t++)for(var r in arguments[t])arguments[t].hasOwnProperty(r)&&(e[r]=arguments[t][r]);return e},getTotalItemsFromResponse:function(e){var n=e.headers("Content-Range");if(void 0!=n&&null!=n){var t=n.split("/");if(2==t.length)return parseInt(t[1])}return null},getRangeItemsFromResponse:function(e){var n=e.headers("Content-Range"),t=0,r=0,i=0;if(n){var a=n.split("/");if(0!=a.length){var s=a[0].split(" ");if(2==s.length){var o=s[1].split("-");2==o.length&&(t=parseInt(o[0]),r=parseInt(o[1]))}2==a.length&&(i=parseInt(a[1]))}}return{top:t,skip:r,totalItems:i}},generateUUID:function(){var e=(new Date).getTime(),n="xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==n?t:3&t|8).toString(16)});return n},getQueryStrParamByName:function(e,n){n||(n=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=t.exec(n);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},validateEmail:function(e){var n=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return n.test(e)}}}])}(),function(){"use strict";angular.module("freeants").factory("imagesRawDataContext",["$http","helpers","path",function(e,n,t){function r(e){return t.api+"/imagesRaw/"+(e||"")}return{createImageRaw:function(t){var i=e({method:"POST",headers:n.getSecurityHeaders(),url:r(),data:'"'+t+'"'}).then(function(e){return e.data});return i},deleteImageRaw:function(t){var i=e({method:"DELETE",headers:n.getSecurityHeaders(),url:r(t)}).then(function(e){return e.data});return i}}}])}(),function(){"use strict";angular.module("freeants").factory("localizator",["$translate",function(e){var n="Language",t=[{name:"English",code:"en-GB"},{name:"Italian",code:"it-IT"}];return{setLocalStorageLabel:function(e){n=e},setSupportedLanguages:function(e){t=e},getSupportedLanguages:function(){return t},changeLanguage:function(r){for(var i=t[0].code,a=0;a<t.length;a++)if(r==t[a].code){localStorage.setItem(n,r),i=r;break}e.use(i)},initLanguage:function(r){var i=localStorage.getItem(n);if(!i){i=t[0].code;for(var a=0;a<t.length;a++)if(r==t[a].code){i=r,localStorage.setItem(n,i);break}}e.use(i)}}}])}(),function(){"use strict";angular.module("freeants").factory("SignalRConnector",function(){function e(e,i){r.logging=!0,r.received(function(e){}),r.error(function(e){}),r.stateChanged(function(n){n.newState===$.signalR.connectionState.connected?(a=!0,s=!0):n.newState===$.signalR.connectionState.disconnected?a=!1:n.newState===$.signalR.connectionState.connecting||n.newState===$.signalR.connectionState.reconnecting,null!=e&&e(n)}),r.reconnected(function(){null!=i&&i()}),r.starting(function(){}),r.connectionSlow(function(){}),r.reconnecting(function(){}),r.disconnected(function(){0!=s&&setTimeout(function(){r.qs=angular.fromJson('{"'+n+'":"'+t()+'"}'),r.start()},5e3)})}var n="",t=null,r=$.hubConnection(),i=r.createHubProxy("signalrnotifier"),a=!1,s=!0;return e.prototype={connected:$.signalR.connectionState.connected,disconnected:$.signalR.connectionState.disconnected,connecting:$.signalR.connectionState.connecting,reconnecting:$.signalR.connectionState.reconnecting,subscribe:function(e,i,s,o,u){if(1!=a){t=s,n=i;var h='{"'+i+'":"'+t()+'"}';e&&""!==e&&(r.url=e),r.qs=angular.fromJson(h),r.start().done(function(){null!=o&&o()}).fail(function(){null!=u&&u()})}},unsubscribe:function(){0!=a&&(s=!1,r.stop())},setHook:function(e,n){i.on(e,n)}},e}),angular.module("freeants").factory("notifierConnector",function(){var e="",n=null,t=$.hubConnection(),r=t.createHubProxy("signalrnotifier"),i=!1,a=!0;return{connected:$.signalR.connectionState.connected,disconnected:$.signalR.connectionState.disconnected,connecting:$.signalR.connectionState.connecting,reconnecting:$.signalR.connectionState.reconnecting,init:function(r,s){t.logging=!0,t.received(function(e){}),t.error(function(e){}),t.stateChanged(function(e){e.newState===$.signalR.connectionState.connected?(i=!0,a=!0):e.newState===$.signalR.connectionState.disconnected?i=!1:e.newState===$.signalR.connectionState.connecting||e.newState===$.signalR.connectionState.reconnecting,null!=r&&r(e)}),t.reconnected(function(){null!=s&&s()}),t.starting(function(){}),t.connectionSlow(function(){}),t.reconnecting(function(){}),t.disconnected(function(){0!=a&&setTimeout(function(){t.qs=angular.fromJson('{"'+e+'":"'+n()+'"}'),t.start()},5e3)})},subscribe:function(r,a,s,o,u){if(1!=i){n=s,e=a;var h='{"'+a+'":"'+n()+'"}';r&&""!==r&&(t.url=r),t.qs=angular.fromJson(h),t.start().done(function(){null!=o&&o()}).fail(function(){null!=u&&u()})}},unsubscribe:function(){0!=i&&(a=!1,t.stop())},setHook:function(e,n){r.on(e,n)},remHook:function(e,n){r.off(e,n)}}})}(),function(){"use strict";angular.module("freeants").factory("pushNotificationsDataContext",["$http","helpers","path","$q",function(e,n,t,r){function i(){return t.api+"/pushNotificationsRegister"}function a(){return t.api+"/pushNotificationsPush"}return{register:function(t){var r=e({method:"PUT",headers:n.getSecurityHeaders(),url:i(),data:t}).then(function(e){return e.data});return r},push:function(t){var r=e({method:"POST",headers:n.getSecurityHeaders(),url:a(),data:t}).then(function(e){return e.data});return r}}}])}(),function(){"use strict";angular.module("freeants").factory("schedulerDataContext",["$http","helpers","path",function(e,n,t){function r(){return t.api+"/Scheduler"}return{schedule:function(t){var i=e({method:"POST",headers:n.getSecurityHeaders(),url:r(),data:t}).then(function(e){return e.data});return i},update:function(t,i){var a=e({method:"PUT",headers:n.getSecurityHeaders(),url:r()+"/"+i,data:t}).then(function(e){return e.data});return a},"delete":function(t,i){var a=e({method:"DELETE",headers:n.getSecurityHeaders(),url:r()+"/"+t+"/"+i,data:null}).then(function(e){return e.data});return a}}}])}(),function(){"use strict";angular.module("freeants").factory("thingsDataContext",["$http","helpers","path","$q",function(e,n,t,r){function i(e,n){return t.api+"/things/"+e+"/childrenIds/"+(n||"")}function a(e){return t.api+"/things/"+(e||"")}function s(e){return t.api+"/things/"+e+"/value"}function o(){return t.api+"/things/position"}function u(){return t.api+"/things/positions"}function h(e,n){return t.api+"/things/"+e+"/childrenIds/"+n}var g=function(){var t=r.defer(),i=function(e){t.resolve(e)},s=e({method:"GET",headers:n.getSecurityHeaders(),timeout:t.promise,url:a()+"?"+(parameter.parentThingId?"&$parentId="+parameter.parentThingId:"")+(parameter.filter?"&$filter="+parameter.filter:"")+(parameter.top?"&$top="+parameter.top:"")+(parameter.skip?"&$skip="+parameter.skip:"")+(null==parameter.deleteStatus||void 0==parameter.deleteStatus?"":"&$deletedStatus="+parameter.deleteStatus)+(parameter.orderBy?"&$orderby="+parameter.orderBy:"")+(parameter.valueFilter?"&$valueFilter="+parameter.valueFilter:"")}).then(function(e){return e.data});return{promise:s,cancel:i}};return{getThings:function(t,r){var i=a()+"?"+(t.parentThingId?"&$parentId="+t.parentThingId:"")+(t.filter?"&$filter="+t.filter:"")+(t.top?"&$top="+t.top:"")+(t.skip?"&$skip="+t.skip:"")+(null==t.deleteStatus||void 0==t.deleteStatus?"":"&$deletedStatus="+t.deleteStatus)+(t.orderBy?"&$orderby="+t.orderBy:"")+(t.valueFilter?"&$valueFilter="+t.valueFilter:""),s=e({method:"GET",headers:n.getSecurityHeaders(),timeout:r?r.promise:null,url:i}).then(function(e){return e.data});return s},getThings1:function(t,r){var i=a()+"?"+(t.parentThingId?"&$parentId="+t.parentThingId:"")+(t.filter?"&$filter="+t.filter:"")+(t.top?"&$top="+t.top:"")+(t.skip?"&$skip="+t.skip:"")+(null==t.deleteStatus||void 0==t.deleteStatus?"":"&$deletedStatus="+t.deleteStatus)+(t.orderBy?"&$orderby="+t.orderBy:"")+(t.valueFilter?"&$valueFilter="+t.valueFilter:""),s=e({method:"GET",headers:n.getSecurityHeaders(),timeout:r?r.promise:null,url:i}).then(function(e){return{things:e.data,itemsRange:n.getRangeItemsFromResponse(e)}});return s},getThing:function(t){var r=e({method:"GET",headers:n.getSecurityHeaders(),url:a(t)}).then(function(e){return e.data});return r},getThingsWithAbort:g,createThing:function(t){var r=e({method:"POST",headers:n.getSecurityHeaders(),url:a(),data:t}).then(function(e){return e.data});return r},updateThing:function(t,r){var i=e({method:"PUT",headers:n.getSecurityHeaders(),url:a(t),data:r}).then(function(e){return e.data});return i},deleteThing:function(t){var r=e({method:"DELETE",headers:n.getSecurityHeaders(),url:a(t)}).then(function(e){return e.data});return r},getChildrenIds:function(t){var r=e({method:"GET",headers:n.getSecurityHeaders(),url:i(t)}).then(function(e){return e.data});return r},addChildToParent:function(t,r){var a=e({method:"POST",headers:n.getSecurityHeaders(),url:i(t),data:angular.toJson(r)}).then(function(e){return e.data});return a},deleteThingChild:function(t,r){var i=e({method:"DELETE",headers:n.getSecurityHeaders(),url:h(t,r)}).then(function(e){return e.data});return i},getThingValue:function(t,r){var i=e({method:"GET",headers:n.getSecurityHeaders(),url:s(t)}).then(function(e){return e.data});return i},putThingValue:function(t,r){var i=e({method:"PUT",headers:n.getSecurityHeaders(),url:s(t),data:r}).then(function(e){return e.data});return i},putThingPosition:function(t,r,i){var a=e({method:"PUT",headers:n.getSecurityHeaders(),url:o(),data:JSON.stringify({parentId:t,childId:r,pos:i})}).then(function(e){return e.data});return a},putThingsPositions:function(t){var r=e({method:"PUT",headers:n.getSecurityHeaders(),url:u(),data:t}).then(function(e){return e.data});return r}}}])}(),function(){"use strict";angular.module("freeants").factory("ThingModel",[function(){function e(e,n,t,r){this.childrenSkip=t?t:0,this.childrenTotalItems=r?r:Number.MAX_SAFE_INTEGER,this.children=n?n:[],this.setData(e)}return e.prototype.setData=function(e){e&&angular.extend(this,e),null!=this.value&&""!=this.value||(this.value={}),this.value=angular.fromJson(this.value)},e.prototype.collapse=function(){this.childrenSkip=0,this.children=[]},e.prototype.shallowCopy=function(){var e=JSON.parse(JSON.stringify(this));return this.children&&(e.children=this.children),this.usersInfos&&(e.usersInfos=this.usersInfos),e},e}])}(),function(){"use strict";angular.module("freeants").factory("ThingsManager",["$q","ThingModel",function(e,n){function t(e){r=e}var r;return t.prototype={getThings:function(e,t){function i(e){for(var t=[],r=0;r<e.length;r++){var i=new n(e[r]);t.push(i)}return t}return r.thingsDataContext.getThings(e,t).then(i)},toThingModel:function(e,t,r){for(var i=0;i<e.length;i++){var a=new n;a.kind=r,a.value=e[i],t.push(a)}},getThingsTree:function(t,i){function a(s,o){var u=o||[];return r.thingsDataContext.getThings(t,i).then(function(r){0==r.length&&s.resolve(u);for(var i=[],o=0;o<r.length;o++){var h=new n(r[o]);u.push(h);var g=e.defer();i.push(g.promise),t.parentThingId=h.id,a(g,h.children)}e.all(i).then(function(e){s.resolve(u)},function(e){s.reject(e)})},function(e){s.reject(e)}),s.promise}var s=e.defer();return a(s)}},t}]),angular.module("freeants").factory("thingsManager",["$q","thingsDataContext","thingUserRightsDataContext","ThingModel",function(e,n,t,r){function i(e,n,t){return n.skip=e.childrenSkip,n.parentThingId=e.id,h(n,t).then(function(t){e.childrenTotalItems=t.itemsRange.totalItems,e.childrenSkip=e.childrenSkip+n.top,e.childrenSkip>e.childrenTotalItems&&(e.childrenSkip=e.childrenTotalItems);for(var r=0;r<t.things.length;r++)e.children.push(t.things[r]);return t})}function a(t,r){return n.getChildrenIds(t).then(function(n){for(var t=[],i=0;i<n.length;i++)t.push(c(n[i],r));return e.all(t)})}function s(e,n){e.children.unshift(new r(n))}function o(e,n){n&&n.resolve(),e.collapse()}function u(e){function t(e){var n=null;return e&&(n=new r(e)),n}return n.getThing(e).then(t)}function h(e,t){function i(e){for(var n=[],t=0;t<e.things.length;t++){var i=new r(e.things[t]);n.push(i)}return{things:n,itemsRange:e.itemsRange}}return n.getThings1(e,t).then(i)}function g(e){return n.createThing(e).then(function(e){return new r(e)})}function c(e,t){return t?a(e,t).then(function(t){return n.deleteThing(e)}):n.deleteThing(e)}function l(e){return e.shallowCopy()}function d(r,i,a){return a?n.getChildrenIds(r).then(function(n){for(var t=[],r=0;r<n.length;r++)t.push(d(n[r],i,a));return e.all(t)}).then(function(e){return t.createThingUserRights(r,i)}):t.createThingUserRights(r,i)}function f(r,i,a,s){return s?n.getChildrenIds(r).then(function(n){for(var t=[],r=0;r<n.length;r++)t.push(f(n[r],i,a,s));return e.all(t)}).then(function(e){return t.updateThingUserRights(r,a)}):t.updateThingUserRights(r,a)}function m(r,i,a){function s(n,r){var i=e.defer();return t.deleteThingUserRights(n,r).then(function(e){return i.resolve(e),e},function(e){return 404==e.status?i.resolve(e):i.reject(e),e}),i.promise}return a?n.getChildrenIds(r).then(function(n){for(var t=[],r=0;r<n.length;r++)t.push(m(n[r],i,a));return e.all(t)}).then(function(e){return s(r,i)}):s(r,i)}return{getThing:u,getThings:h,createThing:g,deleteThing:c,getMoreThingChildren:i,deleteThingChildren:a,addThingChild:s,collapseThing:o,shallowCopyThing:l,addUser:d,updateUser:f,removeUser:m}}])}(),function(){"use strict";angular.module("freeants").factory("thingUserRightsDataContext",["$q","$http","helpers","path",function(e,n,t,r){function i(e,n){return r.api+"/things/"+e+"/usersrights"+(void 0!=n?"/"+n:"")}return{getThingUsersRights:function(e){var r=n({method:"GET",headers:t.getSecurityHeaders(),
url:i(e.thingId)+"?"+(e.filter?"&$filter="+e.filter:"")+(e.top?"&$top="+e.top:"")+(e.skip?"&$skip="+e.skip:"")+(e.orderBy?"&$orderby="+e.orderBy:"")}).then(function(e){return e.data});return r},createThingUserRights:function(e,r){var a=n({method:"POST",headers:t.getSecurityHeaders(),url:i(e),data:r}).then(function(e){return e.data});return a},updateThingUserRights:function(e,r,a){var s=n({method:"PUT",headers:t.getSecurityHeaders(),url:i(e,r),data:a}).then(function(e){return e.data});return s},deleteThingUserRights:function(e,r){var a=n({method:"DELETE",headers:t.getSecurityHeaders(),url:i(e,r)}).then(function(e){return e.data});return a}}}])}(),function(){"use strict";angular.module("freeants").factory("translationService",["$translate",function(e){var n={},t=[],r="Language";return{getSupportedLanguages:function(){return t},changeLanguage:function(n){for(var i=t[0].code,a=0;a<t.length;a++)if(n==t[a].code){localStorage.setItem(r,n),i=n;break}e.refresh(i),e.use(i)},setLocalStorageLabel:function(e){r=e},getCurrentLanguage:function(){return localStorage.getItem(r)},initLanguage:function(n){var i=localStorage.getItem(r);if(!i){i=t[0].code;for(var a=0;a<t.length;a++)if(n==t[a].code){i=n;break}}e.refresh(i),e.use(i)},setLanguages:function(e){angular.merge(n,e)},initialize:function(e){angular.merge(n,e)},getLanguages:function(e){return n},setSupportedLanguages:function(e){t=e},getSupportedLanguages:function(){return t},setGlobalization:function(n){var r="English",i="en-GB",a=n;a||(a=e.use());for(var s=0;s<t.length;s++)a==t[s].code&&(r=t[s].deviceLanguage,i=t[s].deviceCulture);e.refresh(i),e.use(i)}}}])}(),function(){"use strict";angular.module("freeants").factory("userDataContext",["$http","helpers","path",function(e,n,t){function r(e){return t.api+"/users/"+(e||"")}return{getUsers:function(t,i){var a=e({method:"GET",headers:n.getSecurityHeaders(),timeout:i?i.promise:null,url:r()+"?"+(t.filter?"&$filter="+t.filter:"")+(t.top?"&$top="+t.top:"")+(t.skip?"&$skip="+t.skip:"")+(t.orderBy?"&$orderby="+t.orderBy:"")}).then(function(e){return{users:e.data,itemsRange:n.getRangeItemsFromResponse(e)}});return a},getUser:function(t){var i=e({method:"GET",headers:n.getSecurityHeaders(),url:r(t)}).then(function(e){return e.data});return i},createUser:function(t){var i=e({method:"POST",headers:n.getSecurityHeaders(),url:r(),data:t}).then(function(e){return e.data});return i},updateUser:function(t,i){var a=e({method:"PUT",headers:n.getSecurityHeaders(),url:r(t),data:i}).then(function(e){return e.data});return a},deleteUser:function(t){var i=e({method:"DELETE",headers:n.getSecurityHeaders(),url:r(t)}).then(function(e){return e.data});return i}}}])}(),function(){"use strict";angular.module("freeants").factory("UsersManager",["$q","$filter","userDataContext",function(e,n,t){function r(){this.skip=0,this.usersTotalItems=Number.MAX_SAFE_INTEGER,this.users=[],this.getUsersParams={filter:"",top:5,skip:this.skip,orderBy:null}}return r.prototype.getUser=function(r){var i=n("filter")(this.users,{id:r});if(0!=i.length){var a=e.defer();return a.resolve(i[0]),a.promise}return t.getUser(r)},r.prototype.getMoreUsers=function(e){var n=this;return n.getUsersParams.skip=n.skip,t.getUsers(this.getUsersParams,e).then(function(e){n.usersTotalItems=e.itemsRange.totalItems,n.skip+=n.getUsersParams.top,n.skip>n.usersTotalItems&&(n.skip=n.usersTotalItems);for(var t=0;t<e.users.length;t++)n.users.push(e.users[t]);return e})},r.prototype.getUsersItems=function(){return this.users.length},r.prototype.getUsersTotalItems=function(){return this.usersTotalItems},r}])}();